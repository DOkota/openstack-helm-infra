network_policy:
  rabbitmq:
    ingress:
      - from:
        - podSelector:
            matchLabels:
              application: keystone
        - podSelector:
            matchLabels:
              application: heat
        - podSelector:
            matchLabels:
              application: glance
        - podSelector:
            matchLabels:
              application: cinder
        - podSelector:
            matchLabels:
              application: aodh
        - podSelector:
            matchLabels:
              application: congress
        - podSelector:
            matchLabels:
              application: barbican
        - podSelector:
            matchLabels:
              application: ceilometer
        - podSelector:
            matchLabels:
              application: designate
        - podSelector:
            matchLabels:
              application: ironic
        - podSelector:
            matchLabels:
              application: magnum
        - podSelector:
            matchLabels:
              application: mistral
        - podSelector:
            matchLabels:
              application: nova
        - podSelector:
            matchLabels:
              application: neutron
        - podSelector:
            matchLabels:
              application: senlin
        - podSelector:
            matchLabels:
              application: placement
        - podSelector:
            matchLabels:
              application: rabbitmq
        - podSelector:
            matchLabels:
              application: prometheus_rabbitmq_exporter
        ports:
          # AMQP port
          - protocol: TCP
            port: 5672
          # HTTP API ports
          - protocol: TCP
            port: 15672
          - protocol: TCP
            port: 80
      - from:
        - podSelector:
            matchLabels:
              application: rabbitmq
        ports:
          # Clustering port AMQP + 20000
          - protocol: TCP
            port: 25672
          # Erlang Port Mapper Daemon (epmd)
          - protocol: TCP
            port: 4369

manifests:
  monitoring:
    prometheus:
      network_policy_exporter: true
  network_policy: true
